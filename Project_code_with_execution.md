# LAST_PROJECT_CODE
# The Project Objective : Knowing which team names have defeated manchester united team ?
----------------------------------------------------------------------------------------------------------------------------------------------------------

# Functions and concepted used in this project :
1- Common Table Expression [CTE]  ||  
2- Case When Statement  ||  
3- Joins [Left Join]  ||  
4- Window Functions [Over , Rank]  ||  

----------------------------------------------------------------------------------------------------------------------------------------------------------

1- First of all : Setting up the home team CTE [In case that manchester united is the home_team]

![project 1](https://user-images.githubusercontent.com/121814714/212477215-724b885c-0a2f-4541-8cba-71254c5017ed.PNG)
---------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------
2- Then , Setting up the away team CTE in order to select from both of them our info [[In case that manchester united is the away_team]

![project 2](https://user-images.githubusercontent.com/121814714/212477401-7e908383-0de5-4467-8826-02fc381a67a6.PNG)
---------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------


3- Selecting columns and and rank the matches by goal difference 

![project 33](https://user-images.githubusercontent.com/121814714/212477545-e0c7cf9f-43a7-4720-bf72-40d659298712.PNG)
---------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------
 
 
4- -- Join the CTEs [Home and Away CTEs] onto the match table

![Project4](https://user-images.githubusercontent.com/121814714/212477643-c3dcc1cc-dad6-4c53-8142-b9d54b3acf08.PNG)
---------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------
